import streamlit as st
import openai
import os

# ฺฉูุฏ API ุงุฒ ูุญุท ุงูู ุฎูุงูุฏู ูโุดูุฏ
openai.api_key = st.secrets["OPENAI_API_KEY"]

st.title("๐ ุชููุฏ ูุฑุงุฑุฏุงุฏ ููุดููุฏ (ูุงุฑุณ)")

st.markdown("ูุทูุงู ุงุทูุงุนุงุช ูุฑุงุฑุฏุงุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ:")

# ูุฑู ฺฏุฑูุชู ุงุทูุงุนุงุช ุงุฒ ฺฉุงุฑุจุฑ
with st.form("contract_form"):
    ุทุฑู_ุงูู = st.text_input("ูุงู ุทุฑู ุงูู")
    ุทุฑู_ุฏูู = st.text_input("ูุงู ุทุฑู ุฏูู")
    ููุถูุน = st.text_area("ููุถูุน ูุฑุงุฑุฏุงุฏ")
    ูุฏุช = st.text_input("ูุฏุช ูุฑุงุฑุฏุงุฏ (ูุซูุงู: ฺฉ ุณุงู)")
    ูุจูุบ = st.text_input("ูุจูุบ ูุฑุงุฑุฏุงุฏ (ูุซูุงู: ฑฐ ูููู ุชููุงู)")
    ุดุฑุงุท_ูุณุฎ = st.text_area("ุดุฑุงุท ูุณุฎ ูุฑุงุฑุฏุงุฏ", value="ุฏุฑ ุตูุฑุช ุชุฎูู ูุฑ ฺฉ ุงุฒ ุทุฑูู...")
    
    submitted = st.form_submit_button("ุชููุฏ ูุฑุงุฑุฏุงุฏ")

if submitted:
    with st.spinner("ุฏุฑ ุญุงู ุชููุฏ ูุฑุงุฑุฏุงุฏ..."):
        prompt = f"""
        ฺฉ ูุฑุงุฑุฏุงุฏ ุฑุณู ู ุญููู ุจู ุฒุจุงู ูุงุฑุณ ุจููุณ. ุงุทูุงุนุงุช ุฒุฑ ุฑุง ุงุณุชูุงุฏู ฺฉู:
        ุทุฑู ุงูู: {ุทุฑู_ุงูู}
        ุทุฑู ุฏูู: {ุทุฑู_ุฏูู}
        ููุถูุน ูุฑุงุฑุฏุงุฏ: {ููุถูุน}
        ูุฏุช: {ูุฏุช}
        ูุจูุบ: {ูุจูุบ}
        ุดุฑุงุท ูุณุฎ: {ุดุฑุงุท_ูุณุฎ}
        
        ูุชู ูุฑุงุฑุฏุงุฏ ุฑุง ุจู ุฒุจุงู ุฑุณู ู ฺฉุงูู ุจููุณ.
        """
        response = openai.ChatCompletion.create(
            model="gpt-3.5-turbo",
            messages=[{"role": "user", "content": prompt}],
            temperature=0.4,
        )
        contract_text = response["choices"][0]["message"]["content"]
        st.success("ูุฑุงุฑุฏุงุฏ ุจุง ููููุช ุชููุฏ ุดุฏ!")
        st.text_area("๐งพ ูุชู ูุฑุงุฑุฏุงุฏ:", contract_text, height=400)
